source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
fertile.data
fertile.data$Fertile
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
fertile.data$Infertility.diagnosis
fertile.data$Fertile
source('~/Desktop/egg_myriad/88_infertility_samples/DOR_analysis/gephi/gephi.R')
fertile.data$Fertile
fertile.data$Infertility.diagnosis
fertile.data$DOR
dor.cor = cor(fertile.data[fertile.data$DOR == 1,])
index.1st.cyto = grep('IL8', colnames(infertility.data))
index.1st.cyto
index.1st.cyto = grep('IL8', colnames(fertile.data))
index.last.cyto = grep('CSF1', colnames(fertile.data))
index.1st.cyto
dor.cor = cor(fertile.data[fertile.data$DOR == 1,index.1st.cyto:index.last.cyto])
dor.cor
lower.tri(dor.cor)
dor.cor[lower.tri(dor.cor),]
dor.cor[lower.tri(dor.cor)]
dor.cor[lower.tri(dor.cor)] = NA
dor.cor
xy <- t(combn(colnames(dor.cor), 2))
data.frame(xy, dist=m[xy])
data.frame(xy, dist=dor.cor[xy])
xy <- t(combn(colnames(dor.cor), 2))
xy
data.frame(xy, dist=dor.cor[xy])
dor.cor.list = data.frame(xy, cor=dor.cor[xy])
dor.cor.list[abs(dor.cor.list$cor) < 0.5]
dor.cor.list[abs(dor.cor.list$cor) < 0.5,]
dor.cor.list[abs(dor.cor.list$cor) > 0.5,]
fac <- factor(iris$Species)
fac
num
num <- as.numeric(fac)
num
newnum <- num[c(1, 100)]
newnum
levels(fac)[newnum]
r
fac
head(num)
newnum
levels(fac)
newnum
levels(fac)[newnum]
fac
levels(fac)[newnum]
levels(fac)
newnum
grep(grep('grep('IL8', colnames(infertility.data)):grep('CSF1', colnames(infertility.data))'))dor.cor
dor.cor
dor.cor.dummy = dor.cor
dor.cor.dummy
dor.cor.id = data.frame(1:length(dor.cor.dummy %>% colnames()), colnames(dor.cor.dummy))
dor.cor.id
colnames(dor.cor.dummy) = 1:length(colnames(dor.cor.dummy))
xy <- t(combn(colnames(dor.cor), 2))
xy
dor.cor.list = data.frame(xy, cor=dor.cor[xy])
dor.cor.list = dor.cor.list[abs(dor.cor.list$cor) > 0.5,]
dor.cor.list
colnames(dor.cor.dummy) = 1:length(colnames(dor.cor.dummy))
xy <- t(combn(colnames(dor.cor.dummy), 2))
xy
dor.cor.list = data.frame(xy, cor=dor.cor.dummy[xy])
dor.cor.list = dor.cor.list[abs(dor.cor.list$cor) > 0.5,]
dor.cor.list
xy <- t(combn(colnames(dor.cor.dummy), 2))
xy
dor.cor.list = data.frame(xy, cor=dor.cor.dummy[xy])
dor.cor.dummy
rownames(dor.cor.dummy) = 1:length(colnames(dor.cor.dummy))
xy <- t(combn(colnames(dor.cor.dummy), 2))
xy
dor.cor.list = data.frame(xy, cor=dor.cor.dummy[xy])
dor.cor.list = dor.cor.list[abs(dor.cor.list$cor) > 0.5,]
dor.cor.list
colnames(dor.cor.list)[1:2] = c('Source', 'Target')
colnames(dor.cor.list)
dor.cor.id
dor.cor.id %>% head()
dor.cor.id = data.frame(id = 1:length(dor.cor.dummy %>% colnames()), label = colnames(dor.cor.dummy))
dor.cor.id %>% head()
?write.csv
write.csv(dor.cor, 'DOR.id.csv', row.names = F)
write.csv(dor.cor.id, 'DOR.id.csv', row.names = F)
write.csv(dor.cor.list, 'DOR.edges.csv', row.names = F)
source('~/Desktop/egg_myriad/88_infertility_samples/DOR_analysis/gephi/gephi.R')
source('~/Desktop/egg_myriad/88_infertility_samples/DOR_analysis/gephi/gephi.R')
fertile.data
fertile.data$DOR
#### controls
dor.cor = cor(fertile.data[fertile.data$DOR == 0,index.1st.cyto:index.last.cyto])
source('~/Desktop/egg_myriad/88_infertility_samples/DOR_analysis/gephi/gephi.R')
dor.cor
dor.cor
fertile.data[fertile.data$DOR == 0,]$IL1B
fertile.data[fertile.data$DOR == 1,]$IL1B
dor.cor
is.na(dor.cor)
rowSums(is.na(dor.cor))
rowSums(is.na(dor.cor)) == ncol(dor.cor)
dor.cor[!rowSums(is.na(dor.cor)) == ncol(dor.cor),]
dor.cor[,!rowSums(is.na(dor.cor)) == ncol(dor.cor)]
!rowSums(is.na(dor.cor)) == ncol(dor.cor)
rowSums(is.na(dor.cor)) == ncol(dor.cor)
rowSums(is.na(dor.cor)) == ncol(dor.cor)%>%sum()
(rowSums(is.na(dor.cor)) == ncol(dor.cor))%>%sum()
ncol(dor.cor)
rowSums(is.na(dor.cor))
dor.cor
dor.cor%>%View()
fertile.data[fertile.data$DOR == 0,]$CSF1
dor.cor.id %>% head()
dor.cor.list
dor.cor.id %>% head()
source('~/Desktop/egg_myriad/88_infertility_samples/DOR_analysis/gephi/gephi.R')
source('~/Desktop/egg_myriad/88_infertility_samples/DOR_analysis/gephi/gephi.R')
source('~/Desktop/egg_myriad/88_infertility_samples/DOR_analysis/gephi/gephi.R')
source('~/Desktop/egg_myriad/88_infertility_samples/DOR_analysis/gephi/gephi.R')
source('~/Desktop/egg_myriad/88_infertility_samples/DOR_analysis/gephi/gephi.R')
?cor
cor.test(fertile.data[fertile.data$DOR == 1,index.1st.cyto:index.last.cyto])
library('psych')
install.packages('psych')
library("psych")
cor.test(fertile.data[fertile.data$DOR == 1,index.1st.cyto:index.last.cyto])
corr.test(fertile.data[fertile.data$DOR == 1,index.1st.cyto:index.last.cyto])
dor.cor.p.val = corr.test(fertile.data[fertile.data$DOR == 1,index.1st.cyto:index.last.cyto])
xy <- t(combn(colnames(dor.cor.p.val), 2))
dor.cor.p.val = corr.test(fertile.data[fertile.data$DOR == 1,index.1st.cyto:index.last.cyto])
dor.cor.p.val
dor.cor.p.val[lower.tri(dor.cor.p.val)] = NA
xy <- t(combn(colnames(dor.cor.p.val), 2))
dor.cor.p.val
colnames(dor.cor.p.val)
dor.cor.p.val
dor.cor.p.val$r
dor.cor.p.val = corr.test(fertile.data[fertile.data$DOR == 1,index.1st.cyto:index.last.cyto])
dor.cor.p.val
dor.cor.p.val$r
dor.cor.dummy
dor.cor.p.val$p
dor.cor.p.val = corr.test(fertile.data[fertile.data$DOR == 1,index.1st.cyto:index.last.cyto])
dor.cor.p.val = dor.cor.p.val$p
dor.cor.p.val[lower.tri(dor.cor.p.val)] = NA
xy <- t(combn(colnames(dor.cor.p.val), 2))
dor.cor.p.val = corr.test(fertile.data[fertile.data$DOR == 1,index.1st.cyto:index.last.cyto])
dor.cor.p.val = dor.cor.p.val$p
dor.cor.p.val[lower.tri(dor.cor.p.val)] = NA
xy <- t(combn(colnames(dor.cor.p.val), 2))
dor.cor.p.val.list = data.frame(xy, cor=dor.cor.p.val[xy])
dor.cor.p.val.list = dor.cor.p.val.list[abs(dor.cor.p.val.list$cor) > 0.8,]
dor.cor.p.val.list
sum(dor.cor.p.val.list$cor<0.2)
dor.cor.p.val = corr.test(fertile.data[fertile.data$DOR == 1,index.1st.cyto:index.last.cyto])
dor.cor.p.val
?corr.test
dor.cor.p.val = corr.test(fertile.data[fertile.data$DOR == 1,index.1st.cyto:index.last.cyto], adjust = 'none')
dor.cor.p.val = dor.cor.p.val$p
dor.cor.p.val = corr.test(fertile.data[fertile.data$DOR == 1,index.1st.cyto:index.last.cyto], adjust = 'none')
dor.cor.p.val
dor.cor.p.val = dor.cor.p.val$p
dor.cor.p.val[lower.tri(dor.cor.p.val)] = NA
xy <- t(combn(colnames(dor.cor.p.val), 2))
dor.cor.p.val.list = data.frame(xy, cor=dor.cor.p.val[xy])
dor.cor.p.val.list = dor.cor.p.val.list[abs(dor.cor.p.val.list$cor) > 0.8,]
dor.cor.p.val.list
sum(dor.cor.p.val.list$cor<0.2)
dor.cor.p.val = corr.test(fertile.data[fertile.data$DOR == 1,index.1st.cyto:index.last.cyto], adjust = 'none')
dor.cor.p.val
dor.cor.p.val$p
dor.cor.p.val = dor.cor.p.val$p
dor.cor.p.val[lower.tri(dor.cor.p.val)] = NA
xy <- t(combn(colnames(dor.cor.p.val), 2))
dor.cor.p.val.list = data.frame(xy, cor=dor.cor.p.val[xy])
# dor.cor.p.val.list = dor.cor.p.val.list[abs(dor.cor.p.val.list$cor) > 0.8,]
dor.cor.p.val.list
sum(dor.cor.p.val.list$cor<0.2)
dor.cor.p.val = corr.test(fertile.data[fertile.data$DOR == 1,index.1st.cyto:index.last.cyto], adjust = 'none')
dor.cor.p.val
dor.cor.p.val$p
dor.cor.p.val = dor.cor.p.val$p
dor.cor.p.val[lower.tri(dor.cor.p.val)] = NA
colnames(dor.cor.p.val) = 1:length(colnames(dor.cor.p.val))
rownames(dor.cor.p.val) = 1:length(colnames(dor.cor.p.val))
xy <- t(combn(colnames(dor.cor.p.val), 2))
dor.cor.p.val.list = data.frame(xy, cor=dor.cor.p.val[xy])
# dor.cor.p.val.list = dor.cor.p.val.list[abs(dor.cor.p.val.list$cor) > 0.8,]
dor.cor.p.val.list
sum(dor.cor.p.val.list$cor<0.2)
# dor.cor.p.val.list = dor.cor.p.val.list[abs(dor.cor.p.val.list$cor) > 0.8,]
dor.cor.p.val.list%>%head()
dor.cor.p.val = corr.test(fertile.data[fertile.data$DOR == 1,index.1st.cyto:index.last.cyto], adjust = 'none')
dor.cor.p.val
dor.cor.p.val$p
dor.cor.p.val = dor.cor.p.val$p
dor.cor.p.val[lower.tri(dor.cor.p.val)] = NA
colnames(dor.cor.p.val) = 1:length(colnames(dor.cor.p.val))
rownames(dor.cor.p.val) = 1:length(colnames(dor.cor.p.val))
xy <- t(combn(colnames(dor.cor.p.val), 2))
dor.cor.p.val.list = data.frame(xy, cor=dor.cor.p.val[xy])
dor.cor.p.val.list = dor.cor.p.val.list[abs(dor.cor.p.val.list$cor) > 0.05,]
dor.cor.p.val.list%>%head()
colnames(dor.cor.p.val.list) = c('Source', 'Target', 'pval')
cor(fertile.data[fertile.data$DOR == 1,index.1st.cyto:index.last.cyto])
cor(fertile.data[fertile.data$DOR == 1,index.1st.cyto:index.last.cyto], method = 'spearman')
generate.for.gephi(0, 'CTRL2')
#### controls
generate.for.gephi = function(DOR, outname){
dor.cor = cor(fertile.data[fertile.data$DOR == DOR,index.1st.cyto:index.last.cyto])
dor.cor[lower.tri(dor.cor)] = NA
dor.cor
dor.cor[,!rowSums(is.na(dor.cor)) == ncol(dor.cor)]
dor.cor.dummy = dor.cor
dor.cor.id = data.frame(Id = 1:length(dor.cor.dummy %>% colnames()), label = colnames(dor.cor.dummy))
dor.cor.id %>% head()
write.csv(dor.cor.id, paste0(outname, '.id.csv'), row.names = F)
colnames(dor.cor.dummy) = 1:length(colnames(dor.cor.dummy))
rownames(dor.cor.dummy) = 1:length(colnames(dor.cor.dummy))
xy <- t(combn(colnames(dor.cor.dummy), 2))
xy
dor.cor.list = data.frame(xy, cor=dor.cor.dummy[xy])
dor.cor.list
dor.cor.list = dor.cor.list[abs(dor.cor.list$cor) > 0.8,]
colnames(dor.cor.list)[1:2] = c('Source', 'Target')
dor.cor.list = dor.cor.list[!is.na(dor.cor.list$Source),]
write.csv(dor.cor.list, paste0(outname, '.edges.csv'), row.names = F)
}
generate.for.gephi(0, 'CTRL2')
#### controls
generate.for.gephi = function(dor, outname){
dor.cor = cor(fertile.data[fertile.data$DOR == dor,index.1st.cyto:index.last.cyto])
dor.cor[lower.tri(dor.cor)] = NA
dor.cor
dor.cor[,!rowSums(is.na(dor.cor)) == ncol(dor.cor)]
dor.cor.dummy = dor.cor
dor.cor.id = data.frame(Id = 1:length(dor.cor.dummy %>% colnames()), label = colnames(dor.cor.dummy))
dor.cor.id %>% head()
write.csv(dor.cor.id, paste0(outname, '.id.csv'), row.names = F)
colnames(dor.cor.dummy) = 1:length(colnames(dor.cor.dummy))
rownames(dor.cor.dummy) = 1:length(colnames(dor.cor.dummy))
xy <- t(combn(colnames(dor.cor.dummy), 2))
xy
dor.cor.list = data.frame(xy, cor=dor.cor.dummy[xy])
dor.cor.list
dor.cor.list = dor.cor.list[abs(dor.cor.list$cor) > 0.8,]
colnames(dor.cor.list)[1:2] = c('Source', 'Target')
dor.cor.list = dor.cor.list[!is.na(dor.cor.list$Source),]
write.csv(dor.cor.list, paste0(outname, '.edges.csv'), row.names = F)
}
generate.for.gephi(0, 'CTRL2')
generate.for.gephi(1, 'DOR2')
dor.cor.list
dor.cor.list%>%head()
source('~/Desktop/egg_myriad/88_infertility_samples/DOR_analysis/gephi/gephi.R')
source('~/Desktop/egg_myriad/88_infertility_samples/DOR_analysis/gephi/gephi.R')
source('~/Desktop/egg_myriad/88_infertility_samples/DOR_analysis/gephi/gephi.R')
dor.cor.list$cor
debugSource('~/Desktop/egg_myriad/88_infertility_samples/DOR_analysis/gephi/gephi.R')
Q
Q
source('~/Desktop/egg_myriad/88_infertility_samples/DOR_analysis/gephi/gephi.R')
