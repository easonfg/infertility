stat_compare_means(method = "t.test")
my_comparisons <- list( c('FERTILE', 'DOR'),  c('FERTILE', 'PCOS'),
c('FERTILE', 'RPL'),  c('FERTILE', 'UNEXPLAINED'), c('FERTILE', 'ENDOMETRIOSIS'))
ggboxplot(plot.data, x = "Infertility.diagnosis", y = "CXCL9",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons)+ # Add pairwise comparisons p-value
stat_compare_means(method = "t.test")
source('~/Desktop/egg_myriad/88_infertility_samples/linear.regression.ana.R')
ggboxplot(plot.data, x = "Infertility.diagnosis", y = "CXCL9",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) # Add pairwise comparisons p-value
my_comparisons <- list( #c('FERTILE', 'DOR'),  c('FERTILE', 'PCOS'),
#c('FERTILE', 'RPL'),  c('FERTILE', 'UNEXPLAINED'),
c('FERTILE', 'ENDOMETRIOSIS'))
ggboxplot(plot.data, x = "Infertility.diagnosis", y = "CXCL9",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) # Add pairwise comparisons p-value
plot.data = org.data[grepl('RPL|DOR|PCOS|ENDOMETRIOSIS|UNEXPLAINED',org.data$Infertility.diagnosis) | org.data$Fertile == 1,]
# plot.data = plot.data[grep('R$', plot.data$CD.of.blood.draw),]
plot.data = plot.data[grep('R', plot.data$CD.of.blood.draw),]
grep('dometr', plot.data$Infertility.diagnosis)
plot.data %>% View()
for (x in c('RPL', 'DOR', 'PCOS', 'ENDOMETRIOSIS', 'UNEXPLAINED')){
plot.data[grep(x, plot.data$Infertility.diagnosis), 'Infertility.diagnosis'] = x
}
plot.data[plot.data$Fertile == 1, 'Infertility.diagnosis'] = 'FERTILE'
my_comparisons <- list( #c('FERTILE', 'DOR'),  c('FERTILE', 'PCOS'),
#c('FERTILE', 'RPL'),  c('FERTILE', 'UNEXPLAINED'),
c('FERTILE', 'ENDOMETRIOSIS'))
ggboxplot(plot.data, x = "Infertility.diagnosis", y = "CXCL9",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) # Add pairwise comparisons p-value
plot.data$Infertility.diagnosis = factor(plot.data$Infertility.diagnosis, levels = c('FERTILE', 'RPL', 'DOR', 'PCOS', 'ENDOMETRIOSIS', 'UNEXPLAINED')))
plot.data = org.data[grepl('RPL|DOR|PCOS|ENDOMETRIOSIS|UNEXPLAINED',org.data$Infertility.diagnosis) | org.data$Fertile == 1,]
plot.data = plot.data[grep('R$', plot.data$CD.of.blood.draw),]
# plot.data = plot.data[grep('R', plot.data$CD.of.blood.draw),]
grep('dometr', plot.data$Infertility.diagnosis)
for (x in c('RPL', 'DOR', 'PCOS', 'ENDOMETRIOSIS', 'UNEXPLAINED')){
plot.data[grep(x, plot.data$Infertility.diagnosis), 'Infertility.diagnosis'] = x
}
plot.data[plot.data$Fertile == 1, 'Infertility.diagnosis'] = 'FERTILE'
plot.data$Infertility.diagnosis = factor(plot.data$Infertility.diagnosis,
levels = c('FERTILE', 'RPL', 'DOR', 'PCOS', 'ENDOMETRIOSIS', 'UNEXPLAINED'))
my_comparisons <- list( #c('FERTILE', 'DOR'),  c('FERTILE', 'PCOS'),
#c('FERTILE', 'RPL'),  c('FERTILE', 'UNEXPLAINED'),
c('FERTILE', 'ENDOMETRIOSIS'))
ggboxplot(plot.data, x = "Infertility.diagnosis", y = "CXCL9",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) # Add pairwise comparisons p-value
plot.data = org.data[grepl('RPL|DOR|PCOS|ENDOMETRIOSIS|UNEXPLAINED',org.data$Infertility.diagnosis) | org.data$Fertile == 1,]
# plot.data = plot.data[grep('R$', plot.data$CD.of.blood.draw),]
plot.data = plot.data[grep('R', plot.data$CD.of.blood.draw),]
grep('dometr', plot.data$Infertility.diagnosis)
#plot.data %>% View()
for (x in c('RPL', 'DOR', 'PCOS', 'ENDOMETRIOSIS', 'UNEXPLAINED')){
plot.data[grep(x, plot.data$Infertility.diagnosis), 'Infertility.diagnosis'] = x
}
plot.data[plot.data$Fertile == 1, 'Infertility.diagnosis'] = 'FERTILE'
plot.data$Infertility.diagnosis = factor(plot.data$Infertility.diagnosis,
levels = c('FERTILE', 'RPL', 'DOR', 'PCOS', 'ENDOMETRIOSIS', 'UNEXPLAINED'))
my_comparisons <- list( #c('FERTILE', 'DOR'),  c('FERTILE', 'PCOS'),
#c('FERTILE', 'RPL'),  c('FERTILE', 'UNEXPLAINED'),
c('FERTILE', 'ENDOMETRIOSIS'))
ggboxplot(plot.data, x = "Infertility.diagnosis", y = "CXCL9",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) # Add pairwise comparisons p-value
# stat_compare_means(method = "t.test")
#res = sapply(colnames(fertile.data)[3:ncol(fertile.data)], function(x){
#  lm.model = glm(as.formula(paste('Fertile ~', x,  '+Age')), family=binomial(link='logit'), data = fertile.data)
#  summary(lm.model)
#  c(summary(lm.model)$coefficients[2,c(1,4)])
#})
#
#res = t(res) %>% data.frame()
#res
#res[,'padj'] = p.adjust(res[,2], method = 'fdr')
#
#res[res$Pr...t.. < 0.05,]
my_comparisons <- list( c('FERTILE', 'DOR'),  c('FERTILE', 'PCOS'),
c('FERTILE', 'RPL'),  c('FERTILE', 'UNEXPLAINED'),
c('FERTILE', 'ENDOMETRIOSIS'))
ggboxplot(plot.data, x = "Infertility.diagnosis", y = "CXCL9",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) # Add pairwise comparisons p-value
plot.data %>% View()
plot.data[,c('CD.of.blood.draw', 'CXCL9', 'Infertility.diagnosis')]
sub.plot.data = plot.data[,c('CD.of.blood.draw', 'CXCL9', 'Infertility.diagnosis')]
sub.plot.data[sub.plot.data$Infertility.diagnosis == 'ENDOMETRIOSIS']
sub.plot.data[sub.plot.data$Infertility.diagnosis == 'ENDOMETRIOSIS',]
source('~/Desktop/egg_myriad/88_infertility_samples/linear.regression.ana.R')
plot.data = org.data[grepl('RPL|DOR|PCOS|ENDOMETRIOSIS|UNEXPLAINED',org.data$Infertility.diagnosis) | org.data$Fertile == 1,]
plot.data = plot.data[grep('R$', plot.data$CD.of.blood.draw),]
# plot.data = plot.data[grep('R', plot.data$CD.of.blood.draw),]
grep('dometr', plot.data$Infertility.diagnosis)
for (x in c('RPL', 'DOR', 'PCOS', 'ENDOMETRIOSIS', 'UNEXPLAINED')){
plot.data[grep(x, plot.data$Infertility.diagnosis), 'Infertility.diagnosis'] = x
}
plot.data[plot.data$Fertile == 1, 'Infertility.diagnosis'] = 'FERTILE'
plot.data$Infertility.diagnosis = factor(plot.data$Infertility.diagnosis,
levels = c('FERTILE', 'RPL', 'DOR', 'PCOS', 'ENDOMETRIOSIS', 'UNEXPLAINED'))
my_comparisons <- list( c('FERTILE', 'DOR'),  c('FERTILE', 'PCOS'),
c('FERTILE', 'RPL'),  c('FERTILE', 'UNEXPLAINED'),
c('FERTILE', 'ENDOMETRIOSIS'))
ggboxplot(plot.data, x = "Infertility.diagnosis", y = "CXCL9",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) # Add pairwise comparisons p-value
my_comparisons <- list( #c('FERTILE', 'DOR'),  c('FERTILE', 'PCOS'),
#c('FERTILE', 'RPL'),  c('FERTILE', 'UNEXPLAINED'),
c('FERTILE', 'ENDOMETRIOSIS'))
ggboxplot(plot.data, x = "Infertility.diagnosis", y = "CXCL9",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) # Add pairwise comparisons p-value
ggboxplot(plot.data, x = "Infertility.diagnosis", y = "CXCL9",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) + # Add pairwise comparisons p-value
theme(legend.position="none")
plot.data = org.data[grepl('RPL|DOR|PCOS|ENDOMETRIOSIS|UNEXPLAINED',org.data$Infertility.diagnosis) | org.data$Fertile == 1,]
# plot.data = plot.data[grep('R$', plot.data$CD.of.blood.draw),]
plot.data = plot.data[grep('R', plot.data$CD.of.blood.draw),]
for (x in c('RPL', 'DOR', 'PCOS', 'ENDOMETRIOSIS', 'UNEXPLAINED')){
plot.data[grep(x, plot.data$Infertility.diagnosis), 'Infertility.diagnosis'] = x
}
plot.data[plot.data$Fertile == 1, 'Infertility.diagnosis'] = 'FERTILE'
plot.data$Infertility.diagnosis = factor(plot.data$Infertility.diagnosis,
levels = c('FERTILE', 'RPL', 'DOR', 'PCOS', 'ENDOMETRIOSIS', 'UNEXPLAINED'))
my_comparisons <- list( #c('FERTILE', 'DOR'),  c('FERTILE', 'PCOS'),
#c('FERTILE', 'RPL'),  c('FERTILE', 'UNEXPLAINED'),
c('FERTILE', 'ENDOMETRIOSIS'))
ggboxplot(plot.data, x = "Infertility.diagnosis", y = "CXCL9",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) + # Add pairwise comparisons p-value
theme(legend.position="none")
source('~/Desktop/egg_myriad/88_infertility_samples/linear.regression.ana.R')
debugSource('~/Desktop/egg_myriad/88_infertility_samples/linear.regression.ana.R')
lm.model
summary(lm.model)
contrasts(fertile.data$Fertile)
Q
source('~/Desktop/egg_myriad/88_infertility_samples/linear.regression.ana.R')
plot.data = org.data[grepl('RPL|DOR|PCOS|ENDOMETRIOSIS|UNEXPLAINED',org.data$Infertility.diagnosis) | org.data$Fertile == 1,]
# plot.data = plot.data[grep('R$', plot.data$CD.of.blood.draw),]
plot.data = plot.data[grep('R', plot.data$CD.of.blood.draw),]
for (x in c('RPL', 'DOR', 'PCOS', 'ENDOMETRIOSIS', 'UNEXPLAINED')){
plot.data[grep(x, plot.data$Infertility.diagnosis), 'Infertility.diagnosis'] = x
}
plot.data[plot.data$Fertile == 1, 'Infertility.diagnosis'] = 'FERTILE'
plot.data$Infertility.diagnosis = factor(plot.data$Infertility.diagnosis,
levels = c('FERTILE', 'RPL', 'DOR', 'PCOS', 'ENDOMETRIOSIS', 'UNEXPLAINED'))
ggboxplot(plot.data, x = "Infertility.diagnosis", y = "TNFSF14",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) + # Add pairwise comparisons p-value
theme(legend.position="none")
my_comparisons <- list( c('FERTILE', 'DOR'),  c('FERTILE', 'PCOS'),
c('FERTILE', 'RPL'),  c('FERTILE', 'UNEXPLAINED'),
c('FERTILE', 'ENDOMETRIOSIS'))
ggboxplot(plot.data, x = "Infertility.diagnosis", y = "TNFSF14",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) + # Add pairwise comparisons p-value
theme(legend.position="none")
plot.data[grep('FERTILE|DOR'),]
plot.data[grep('FERTILE|DOR', plot.data$Infertility.diagnosis),]
my_comparisons <- list( c('FERTILE', 'DOR'),  c('FERTILE', 'PCOS'),
c('FERTILE', 'RPL'),  c('FERTILE', 'UNEXPLAINED'),
c('FERTILE', 'ENDOMETRIOSIS'))
ggboxplot(plot.data[grep('FERTILE|DOR', plot.data$Infertility.diagnosis),], x = "Infertility.diagnosis", y = "TNFSF14",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) + # Add pairwise comparisons p-value
theme(legend.position="none")
my_comparisons <- list( c('FERTILE', 'DOR'),  c('FERTILE', 'PCOS'),
c('FERTILE', 'RPL'),  c('FERTILE', 'UNEXPLAINED'),
c('FERTILE', 'ENDOMETRIOSIS'))
ggboxplot(plot.data[grep('FERTILE|DOR', plot.data$Infertility.diagnosis),], x = "Infertility.diagnosis", y = "TNFSF14",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) + # Add pairwise comparisons p-value
theme(legend.position="none")
print(all.res[all.res$padj < 0.05,])
my_comparisons <- list( c('FERTILE', 'DOR'))
ggboxplot(plot.data[grep('FERTILE|DOR', plot.data$Infertility.diagnosis),], x = "Infertility.diagnosis", y = "TNFSF14",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) + # Add pairwise comparisons p-value
theme(legend.position="none")
plot.data[grep('FERTILE|DOR', plot.data$Infertility.diagnosis),]
plot.data[grep('FERTILE|DOR', plot.data$Infertility.diagnosis),] %>%
ggplot(aes(x=Infertility.diagnosis,y=TNFSF14, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
# jittered text with geom_text
geom_text(check_overlap = TRUE,
position=position_jitter(width=0.15))+
theme(legend.position="none")
plot.data %>%
ggplot(aes(x=Infertility.diagnosis,y=CXCL9, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
# jittered text with geom_text
geom_text(check_overlap = TRUE,
position=position_jitter(width=0.15))+
theme(legend.position="none")
plot.data %>%
ggplot(aes(x=Infertility.diagnosis,y=CXCL9, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
# jittered text with geom_text
geom_text(check_overlap = TRUE,
position=position_jitter(width=0.15))+
theme_classic()+
theme(legend.position="none")
plot.data = org.data[grepl('RPL|DOR|PCOS|ENDOMETRIOSIS|UNEXPLAINED',org.data$Infertility.diagnosis) | org.data$Fertile == 1,]
plot.data = plot.data[grep('R$', plot.data$CD.of.blood.draw),]
for (x in c('RPL', 'DOR', 'PCOS', 'ENDOMETRIOSIS', 'UNEXPLAINED')){
plot.data[grep(x, plot.data$Infertility.diagnosis), 'Infertility.diagnosis'] = x
}
plot.data[plot.data$Fertile == 1, 'Infertility.diagnosis'] = 'FERTILE'
plot.data$Infertility.diagnosis = factor(plot.data$Infertility.diagnosis,
levels = c('FERTILE', 'RPL', 'DOR', 'PCOS', 'ENDOMETRIOSIS', 'UNEXPLAINED'))
### plotting the significant R only cytokines (CXCL9)
my_comparisons <- list( #c('FERTILE', 'DOR'),  c('FERTILE', 'PCOS'),
#c('FERTILE', 'RPL'),  c('FERTILE', 'UNEXPLAINED'),
c('FERTILE', 'ENDOMETRIOSIS'))
ggboxplot(plot.data, x = "Infertility.diagnosis", y = "CXCL9",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) + # Add pairwise comparisons p-value
theme(legend.position="none")
plot.data %>%
ggplot(aes(x=Infertility.diagnosis,y=CXCL9, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
# jittered text with geom_text
geom_text(check_overlap = TRUE,
position=position_jitter(width=0.15))+
theme_classic()+
theme(legend.position="none")
ggboxplot(plot.data, x = "Infertility.diagnosis", y = "CXCL9",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) + # Add pairwise comparisons p-value
theme(legend.position="none")
plot.data %>%
ggplot(aes(x=Infertility.diagnosis,y=CXCL9, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
# jittered text with geom_text
geom_text(check_overlap = TRUE,
position=position_jitter(width=0.15))+
theme_classic()+
theme(legend.position="none")
ggboxplot(plot.data, x = "Infertility.diagnosis", y = "CXCL9",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) + # Add pairwise comparisons p-value
theme(legend.position="none")
plot.data %>%
ggplot(aes(x=Infertility.diagnosis,y=CXCL9, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
# jittered text with geom_text
geom_text(check_overlap = TRUE,
position=position_jitter(width=0.15))+
theme_classic()+
theme(legend.position="none")
ggboxplot(plot.data, x = "Infertility.diagnosis", y = "CXCL9",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) + # Add pairwise comparisons p-value
theme(legend.position="none")
plot.data %>%
ggplot(aes(x=Infertility.diagnosis,y=CXCL9, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
# jittered text with geom_text
geom_text(check_overlap = TRUE,
position=position_jitter(width=0.15))+
theme_classic()+
theme(legend.position="none")
plot.data
plot.data$Infertility.diagnosis == 'ENDOMETRIOSIS'
sum(plot.data$Infertility.diagnosis == 'ENDOMETRIOSIS')
plot.data %>%
ggplot(aes(x=Infertility.diagnosis,y=CXCL9, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.05)+
# jittered text with geom_text
geom_text(check_overlap = TRUE,
position=position_jitter(width=0.15))+
theme_classic()+
theme(legend.position="none")
plot.data %>%
ggplot(aes(x=Infertility.diagnosis,y=CXCL9, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
# jittered text with geom_text
geom_text(check_overlap = TRUE,
position=position_jitter(width=0.15))+
theme_classic()+
theme(legend.position="none")
plot.data %>%
ggplot(aes(x=Infertility.diagnosis,y=CXCL9, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
# jittered text with geom_text
geom_text(check_overlap = TRUE,
position=position_jitter(width=0.15))+
theme_classic()+
theme(legend.position="none")
ggboxplot(plot.data, x = "Infertility.diagnosis", y = "CXCL9",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) + # Add pairwise comparisons p-value
theme(legend.position="none")
plot.data %>%
ggplot(aes(x=Infertility.diagnosis,y=CXCL9, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
# jittered text with geom_text
geom_text(
position=position_jitter(width=0.15))+
theme_classic()+
theme(legend.position="none")
plot.data = org.data[grepl('RPL|DOR|PCOS|ENDOMETRIOSIS|UNEXPLAINED',org.data$Infertility.diagnosis) | org.data$Fertile == 1,]
# plot.data = plot.data[grep('R$', plot.data$CD.of.blood.draw),]
plot.data = plot.data[grep('R', plot.data$CD.of.blood.draw),]
for (x in c('RPL', 'DOR', 'PCOS', 'ENDOMETRIOSIS', 'UNEXPLAINED')){
plot.data[grep(x, plot.data$Infertility.diagnosis), 'Infertility.diagnosis'] = x
}
plot.data[plot.data$Fertile == 1, 'Infertility.diagnosis'] = 'FERTILE'
plot.data$Infertility.diagnosis = factor(plot.data$Infertility.diagnosis,
levels = c('FERTILE', 'RPL', 'DOR', 'PCOS', 'ENDOMETRIOSIS', 'UNEXPLAINED'))
### plotting the significant R only cytokines (CXCL9)
my_comparisons <- list( #c('FERTILE', 'DOR'),  c('FERTILE', 'PCOS'),
#c('FERTILE', 'RPL'),  c('FERTILE', 'UNEXPLAINED'),
c('FERTILE', 'ENDOMETRIOSIS'))
ggboxplot(plot.data, x = "Infertility.diagnosis", y = "CXCL9",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) + # Add pairwise comparisons p-value
theme(legend.position="none")
plot.data %>%
ggplot(aes(x=Infertility.diagnosis,y=CXCL9, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
# jittered text with geom_text
geom_text(
position=position_jitter(width=0.15))+
theme_classic()+
theme(legend.position="none")
sub.plot.data = plot.data[,c('CD.of.blood.draw', 'CXCL9', 'Infertility.diagnosis')]
sub.plot.data[sub.plot.data$Infertility.diagnosis == 'ENDOMETRIOSIS',]
plot.data[grep('FERTILE|DOR', plot.data$Infertility.diagnosis),] %>%
ggplot(aes(x=Infertility.diagnosis,y=TNFSF14, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
# jittered text with geom_text
geom_text(check_overlap = TRUE,
position=position_jitter(width=0.15))+
theme(legend.position="none")
plot.data[grep('FERTILE|DOR', plot.data$Infertility.diagnosis),] %>%
ggplot(aes(x=Infertility.diagnosis,y=TNFSF14, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
theme_classic()+
# jittered text with geom_text
geom_text(check_overlap = TRUE,
position=position_jitter(width=0.15))+
theme(legend.position="none")
print(all.res[all.res$padj < 0.05,])
plot.data[grep('FERTILE|DOR', plot.data$Infertility.diagnosis),] %>%
ggplot(aes(x=Infertility.diagnosis,y=CD40, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
theme_classic()+
# jittered text with geom_text
geom_text(check_overlap = TRUE,
position=position_jitter(width=0.15))+
theme(legend.position="none")
plot.data[grep('FERTILE|PCOS', plot.data$Infertility.diagnosis),] %>%
ggplot(aes(x=Infertility.diagnosis,y=FGF21, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
theme_classic()+
# jittered text with geom_text
geom_text(check_overlap = TRUE,
position=position_jitter(width=0.15))+
theme(legend.position="none")
plot.data %>%
ggplot(aes(x=Infertility.diagnosis,y=CXCL9, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
# jittered text with geom_text
geom_text(
position=position_jitter(width=0.15))+
theme_classic()+
theme(legend.position="none")
source('~/Desktop/egg_myriad/88_infertility_samples/linear.regression.ana.R')
dim(all.res)
dim(cytokines.data)
all.res
table(all.res$diag)
dim(cytokines.data)
debugSource('~/Desktop/egg_myriad/88_infertility_samples/linear.regression.ana.R')
dim(cytokines.data)
dim(fertile.data)
infertility.data
infertility.data$Infertility.diagnosis
source('~/Desktop/egg_myriad/88_infertility_samples/linear.regression.ana.R')
source('~/Desktop/egg_myriad/88_infertility_samples/linear.regression.ana.R')
plot.data = org.data[grepl('RPL|DOR|PCOS|ENDOMETRIOSIS|UNEXPLAINED',org.data$Infertility.diagnosis) | org.data$Fertile == 1,]
# plot.data = plot.data[grep('R$', plot.data$CD.of.blood.draw),]
plot.data = plot.data[grep('R', plot.data$CD.of.blood.draw),]
for (x in c('RPL', 'DOR', 'PCOS', 'ENDOMETRIOSIS', 'UNEXPLAINED')){
plot.data[grep(x, plot.data$Infertility.diagnosis), 'Infertility.diagnosis'] = x
}
plot.data[plot.data$Fertile == 1, 'Infertility.diagnosis'] = 'FERTILE'
plot.data$Infertility.diagnosis = factor(plot.data$Infertility.diagnosis,
levels = c('FERTILE', 'RPL', 'DOR', 'PCOS', 'ENDOMETRIOSIS', 'UNEXPLAINED'))
### plotting the significant R only cytokines (CXCL9)
my_comparisons <- list( #c('FERTILE', 'DOR'),  c('FERTILE', 'PCOS'),
#c('FERTILE', 'RPL'),  c('FERTILE', 'UNEXPLAINED'),
c('FERTILE', 'ENDOMETRIOSIS'))
ggboxplot(plot.data, x = "Infertility.diagnosis", y = "CXCL9",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) + # Add pairwise comparisons p-value
theme(legend.position="none")
plot.data %>%
ggplot(aes(x=Infertility.diagnosis,y=CXCL9, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
# jittered text with geom_text
geom_text(
position=position_jitter(width=0.15))+
theme_classic()+
theme(legend.position="none")
debugSource('~/Desktop/egg_myriad/88_infertility_samples/linear.regression.ana.R')
infertility.data$Infertility.diagnosis
debugSource('~/Desktop/egg_myriad/88_infertility_samples/linear.regression.ana.R')
infertility.data$Infertility.diagnosis
source('~/Desktop/egg_myriad/88_infertility_samples/linear.regression.ana.R')
all.res
source('~/Desktop/egg_myriad/88_infertility_samples/linear.regression.ana.R')
plot.data = org.data[grepl('RPL|DOR|PCOS|ENDOMETRIOSIS|UNEXPLAINED',org.data$Infertility.diagnosis) | org.data$Fertile == 1,]
plot.data = plot.data[grep('R$', plot.data$CD.of.blood.draw),]
for (x in c('RPL', 'DOR', 'PCOS', 'ENDOMETRIOSIS', 'UNEXPLAINED')){
plot.data[grep(x, plot.data$Infertility.diagnosis), 'Infertility.diagnosis'] = x
}
plot.data[plot.data$Fertile == 1, 'Infertility.diagnosis'] = 'FERTILE'
plot.data$Infertility.diagnosis = factor(plot.data$Infertility.diagnosis,
levels = c('FERTILE', 'RPL', 'DOR', 'PCOS', 'ENDOMETRIOSIS', 'UNEXPLAINED'))
### plotting the significant R only cytokines (CXCL9)
my_comparisons <- list( #c('FERTILE', 'DOR'),  c('FERTILE', 'PCOS'),
#c('FERTILE', 'RPL'),  c('FERTILE', 'UNEXPLAINED'),
c('FERTILE', 'ENDOMETRIOSIS'))
ggboxplot(plot.data, x = "Infertility.diagnosis", y = "CXCL9",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) + # Add pairwise comparisons p-value
theme(legend.position="none")
plot.data %>%
ggplot(aes(x=Infertility.diagnosis,y=CXCL9, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
# jittered text with geom_text
geom_text(
position=position_jitter(width=0.15))+
theme_classic()+
theme(legend.position="none")
source('~/Desktop/egg_myriad/88_infertility_samples/linear.regression.ana.R')
source('~/Desktop/egg_myriad/88_infertility_samples/linear.regression.ana.R')
source('~/Desktop/egg_myriad/88_infertility_samples/linear.regression.ana.R')
all.res[all.res$diag == 'ENDOMETRIOSIS',]
all.res[all.res$diag == 'ENDOMETRIOSIS'& grepl('CXCL9', rownames(all.res)),]
source('~/Desktop/egg_myriad/88_infertility_samples/linear.regression.ana.R')
source('~/Desktop/egg_myriad/88_infertility_samples/linear.regression.ana.R')
plot.data[grep('FERTILE|DOR', plot.data$Infertility.diagnosis),] %>%
ggplot(aes(x=Infertility.diagnosis,y=ST1A1, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
theme_classic()+
# jittered text with geom_text
geom_text(check_overlap = TRUE,
position=position_jitter(width=0.15))+
theme(legend.position="none")
plot.data = org.data[grepl('RPL|DOR|PCOS|ENDOMETRIOSIS|UNEXPLAINED',org.data$Infertility.diagnosis) | org.data$Fertile == 1,]
# plot.data = plot.data[grep('R$', plot.data$CD.of.blood.draw),]
plot.data = plot.data[grep('R', plot.data$CD.of.blood.draw),]
for (x in c('RPL', 'DOR', 'PCOS', 'ENDOMETRIOSIS', 'UNEXPLAINED')){
plot.data[grep(x, plot.data$Infertility.diagnosis), 'Infertility.diagnosis'] = x
}
plot.data[plot.data$Fertile == 1, 'Infertility.diagnosis'] = 'FERTILE'
plot.data$Infertility.diagnosis = factor(plot.data$Infertility.diagnosis,
levels = c('FERTILE', 'RPL', 'DOR', 'PCOS', 'ENDOMETRIOSIS', 'UNEXPLAINED'))
### plotting the significant R only cytokines (CXCL9)
my_comparisons <- list( #c('FERTILE', 'DOR'),  c('FERTILE', 'PCOS'),
#c('FERTILE', 'RPL'),  c('FERTILE', 'UNEXPLAINED'),
c('FERTILE', 'ENDOMETRIOSIS'))
ggboxplot(plot.data, x = "Infertility.diagnosis", y = "CXCL9",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) + # Add pairwise comparisons p-value
theme(legend.position="none")
plot.data %>%
ggplot(aes(x=Infertility.diagnosis,y=CXCL9, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
# jittered text with geom_text
geom_text(
position=position_jitter(width=0.15))+
theme_classic()+
theme(legend.position="none")
### plotting the significant R+n cytokines
my_comparisons <- list( c('FERTILE', 'DOR'),  c('FERTILE', 'PCOS'),
c('FERTILE', 'RPL'),  c('FERTILE', 'UNEXPLAINED'),
c('FERTILE', 'ENDOMETRIOSIS'))
my_comparisons <- list( c('FERTILE', 'DOR'))
ggboxplot(plot.data[grep('FERTILE|DOR', plot.data$Infertility.diagnosis),], x = "Infertility.diagnosis", y = "TNFSF14",
color = "Infertility.diagnosis", palette = "jco", add = "jitter") +
stat_compare_means(comparisons = my_comparisons) + # Add pairwise comparisons p-value
theme(legend.position="none")
plot.data[grep('FERTILE|DOR', plot.data$Infertility.diagnosis),] %>%
ggplot(aes(x=Infertility.diagnosis,y=TNFSF14, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
theme_classic()+
# jittered text with geom_text
geom_text(check_overlap = TRUE,
position=position_jitter(width=0.15))+
theme(legend.position="none")
plot.data[grep('FERTILE|DOR', plot.data$Infertility.diagnosis),] %>%
ggplot(aes(x=Infertility.diagnosis,y=CD40, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
theme_classic()+
# jittered text with geom_text
geom_text(check_overlap = TRUE,
position=position_jitter(width=0.15))+
theme(legend.position="none")
plot.data[grep('FERTILE|DOR', plot.data$Infertility.diagnosis),] %>%
ggplot(aes(x=Infertility.diagnosis,y=ST1A1, label = CD.of.blood.draw, color=Infertility.diagnosis))+
geom_boxplot(width=.5)+
theme_classic()+
# jittered text with geom_text
geom_text(check_overlap = TRUE,
position=position_jitter(width=0.15))+
theme(legend.position="none")
